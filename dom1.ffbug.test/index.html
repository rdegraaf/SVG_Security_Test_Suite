<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8"/>
    <title>Firefox CSP Violations</title>
    <link rel="stylesheet" type="text/css" href="index.css"/>
  </head>
  <body>
    <h1>Firefox CSP Violations</h1>
    <p>
      <code>Content-Security-Policy: default-src 'none'; script-src 'self'; style-src 'self'; frame-src 'self'</code>
    </p>
    <h3>SVG circle with in-line CSS</h3>
    <p>Expected: 2 gray circles; 1 load failure.  CSS blocked by <code>style-src</code>; in-line SVG blocked by <code>img-src</code>.</p>
    <p>
      <iframe src="circle-css.svg" width="68" height="68"></iframe>
      <iframe src="circle-css.svg" width="68" height="68" sandbox=""></iframe>
      <span class="image"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
        <svg
           xmlns="http://www.w3.org/2000/svg"
           xmlns:xlink="http://www.w3.org/1999/xlink"
           width="68"
           height="68"
           id="svg2"
           version="1.1">
          <style>
            #path0002 {fill: orange !important; }
          </style>
          <circle
             cx="34"
             cy="34"
             r="24"
             fill="#c8c8c8"
             fill-opacity="1"
             stroke-width="2"
             stroke-miterlimit="4"
             stroke-dasharray="none"
             id="path0002"/>
        </svg>
      </span>
    </p>
    <h3>SVG circle with cross-domain CSS</h3>
    <p>Expected: 2 gray circles; 1 load failure.  CSS blocked by <code>style-src</code>; in-line SVG blocked by <code>img-src</code>.</p>
    <p>
      <iframe src="circle-css-cross-domain.svg" width="68" height="68"></iframe>
      <iframe src="circle-css-cross-domain.svg" width="68" height="68" sandbox=""></iframe>
      <span class="image"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
        <?xml-stylesheet type="text/css" href="http://dom2.ffbug.test/circle.css"?>
        <svg
           xmlns="http://www.w3.org/2000/svg"
           xmlns:xlink="http://www.w3.org/1999/xlink"
           width="68"
           height="68"
           id="svg2"
           version="1.1">
          <circle
             cx="34"
             cy="34"
             r="24"
             fill="#c8c8c8"
             fill-opacity="1"
             stroke-width="2"
             stroke-miterlimit="4"
             stroke-dasharray="none"
             id="path0007"/>
        </svg>
      </span>
    </p>
    <h3>SVG circle that embeds a same-origin SVG</h3>
    <p>Expected: 2 gray circles; 1 load failure.  CSS blocked by <code>style-src</code>; child SVG and in-line SVG blocked by <code>img-src</code>.</p>
    <p>
      <iframe src="circle-emb-circle.svg" width="68" height="68"></iframe>
      <iframe src="circle-emb-circle.svg" width="68" height="68" sandbox=""></iframe>
      <span class="image"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
        <svg
           xmlns="http://www.w3.org/2000/svg"
           xmlns:xlink="http://www.w3.org/1999/xlink"
           width="68"
           height="68"
           id="svg2"
           version="1.1">
          <circle
             cx="34"
             cy="34"
             r="24"
             fill="#c8c8c8"
             fill-opacity="1"
             stroke-width="2"
             stroke-miterlimit="4"
             stroke-dasharray="none"
             id="path0009"/>
          <image x="34" y="34" width="34" height="34" xlink:href="circle.svg" />
        </svg>
      </span>
    </p>
    <h3>SVG circle that embeds a cross-origin SVG</h3>
    <p>Expected: 2 gray circles; 1 load failure.  CSS blocked by <code>style-src</code>; child SVG and in-line SVG blocked by <code>img-src</code>.</p>
    <p>
      <iframe src="circle-emb-xd-circle.svg" width="68" height="68"></iframe>
      <iframe src="circle-emb-xd-circle.svg" width="68" height="68" sandbox=""></iframe>
      <span class="image"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
        <svg
           xmlns="http://www.w3.org/2000/svg"
           xmlns:xlink="http://www.w3.org/1999/xlink"
           width="68"
           height="68"
           id="svg2"
           version="1.1">
          <circle
             cx="34"
             cy="34"
             r="24"
             fill="#c8c8c8"
             fill-opacity="1"
             stroke-width="2"
             stroke-miterlimit="4"
             stroke-dasharray="none"
             id="path0015"/>
          <image x="34" y="34" width="34" height="34" xlink:href="http://dom2.ffbug.test/circle.svg"/>
        </svg>
      </span>
    </p>
    <h3>SVG circle that embeds a cross-origin SVG with in-line CSS through HTML</h3>
    <p>Expected: 2 gray circles; 1 load failure.  CSS blocked by <code>style-src</code>; child SVG and in-line SVG blocked by <code>img-src</code>.</p>
    <p>
      <iframe src="circle-emb-html-xd-circle-css.svg" width="68" height="68"></iframe>
      <iframe src="circle-emb-html-xd-circle-css.svg" width="68" height="68" sandbox=""></iframe>
      <span class="image"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
        <svg
           xmlns="http://www.w3.org/2000/svg"
           xmlns:xlink="http://www.w3.org/1999/xlink"
           width="68"
           height="68"
           id="svg2"
           version="1.1">
          <circle
             cx="34"
             cy="34"
             r="24"
             fill="#c8c8c8"
             fill-opacity="1"
             stroke-width="2"
             stroke-miterlimit="4"
             stroke-dasharray="none"
             id="path0024"/>
          <foreignObject x="34" y="34" width="34" height="34" requiredExtensions="http://www.w3.org/1999/xhtml">
            <head>
              <style>
                document,body,img {
                  padding: 0px;
                  margin: 0px;
                  border: 0px;
                }
              </style>
            </head>
            <body xmlns="http://www.w3.org/1999/xhtml">
              <object width="34" height="34" type="image/svg+xml" data="http://dom2.ffbug.test/circle-css.svg"></object>
            </body>
          </foreignObject>
        </svg>
      </span>
    </p>
    <h3>SVG circle that embeds a cross-origin SVG with external CSS through HTML</h3>
    <p>Expected: 2 gray circles; 1 load failure.  CSS blocked by <code>style-src</code>; child SVG and in-line SVG blocked by <code>img-src</code>.</p>
    <p>
      <iframe src="circle-emb-html-xd-circle-css-external.svg" width="68" height="68"></iframe>
      <iframe src="circle-emb-html-xd-circle-css-external.svg" width="68" height="68" sandbox=""></iframe>
      <span class="image"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
        <svg
           xmlns="http://www.w3.org/2000/svg"
           xmlns:xlink="http://www.w3.org/1999/xlink"
           width="68"
           height="68"
           id="svg2"
           version="1.1">
          <circle
             cx="34"
             cy="34"
             r="24"
             fill="#c8c8c8"
             fill-opacity="1"
             stroke-width="2"
             stroke-miterlimit="4"
             stroke-dasharray="none"
             id="path0024"/>
          <foreignObject x="34" y="34" width="34" height="34" requiredExtensions="http://www.w3.org/1999/xhtml">
            <head>
              <style>
                document,body,img {
                  padding: 0px;
                  margin: 0px;
                  border: 0px;
                }
              </style>
            </head>
            <body xmlns="http://www.w3.org/1999/xhtml">
              <object width="34" height="34" type="image/svg+xml" data="http://dom2.ffbug.test/circle-css-external.svg"></object>
            </body>
          </foreignObject>
        </svg>
      </span>
    </p>
  </body>
</html>

